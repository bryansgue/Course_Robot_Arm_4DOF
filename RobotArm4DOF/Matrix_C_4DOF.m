function C = Matrix_C_4DOF(m1,m2,m3,m4,I1,I2,I3,I4,l1,l2,l3,l4,q1,q2,q3,q4,q1_p,q2_p,q3_p,q4_p)

C = [- q3_p*((l3^2*m3*sin(2*q2 + 2*q3))/2 + (l3^2*m4*sin(2*q2 + 2*q3))/2 + (l4^2*m4*sin(2*q2 + 2*q3 + 2*q4))/2 + (l2*l4*m4*sin(2*q2 + q3 + q4))/2 + (l2*l4*m4*sin(q3 + q4))/2 + (l2*l3*m3*sin(q3))/2 + (l2*l3*m4*sin(q3))/2 + l3*l4*m4*sin(2*q2 + 2*q3 + q4) + (l2*l3*m3*sin(2*q2 + q3))/2 + (l2*l3*m4*sin(2*q2 + q3))/2) - q2_p*((l3^2*m3*sin(2*q2 + 2*q3))/2 + (l3^2*m4*sin(2*q2 + 2*q3))/2 + (l2^2*m2*sin(2*q2))/2 + (l2^2*m3*sin(2*q2))/2 + (l2^2*m4*sin(2*q2))/2 + (l4^2*m4*sin(2*q2 + 2*q3 + 2*q4))/2 + l2*l4*m4*sin(2*q2 + q3 + q4) + l3*l4*m4*sin(2*q2 + 2*q3 + q4) + l2*l3*m3*sin(2*q2 + q3) + l2*l3*m4*sin(2*q2 + q3)) - (l4*m4*q4_p*(l4*sin(2*q2 + 2*q3 + 2*q4) + l2*sin(2*q2 + q3 + q4) + l2*sin(q3 + q4) + l3*sin(q4) + l3*sin(2*q2 + 2*q3 + q4)))/2, -q1_p*((l3^2*m3*sin(2*q2 + 2*q3))/2 + (l3^2*m4*sin(2*q2 + 2*q3))/2 + (l2^2*m2*sin(2*q2))/2 + (l2^2*m3*sin(2*q2))/2 + (l2^2*m4*sin(2*q2))/2 + (l4^2*m4*sin(2*q2 + 2*q3 + 2*q4))/2 + l2*l4*m4*sin(2*q2 + q3 + q4) + l3*l4*m4*sin(2*q2 + 2*q3 + q4) + l2*l3*m3*sin(2*q2 + q3) + l2*l3*m4*sin(2*q2 + q3)), -q1_p*((l3^2*m3*sin(2*q2 + 2*q3))/2 + (l3^2*m4*sin(2*q2 + 2*q3))/2 + (l4^2*m4*sin(2*q2 + 2*q3 + 2*q4))/2 + (l2*l4*m4*sin(2*q2 + q3 + q4))/2 + (l2*l4*m4*sin(q3 + q4))/2 + (l2*l3*m3*sin(q3))/2 + (l2*l3*m4*sin(q3))/2 + l3*l4*m4*sin(2*q2 + 2*q3 + q4) + (l2*l3*m3*sin(2*q2 + q3))/2 + (l2*l3*m4*sin(2*q2 + q3))/2), -(l4*m4*q1_p*(l4*sin(2*q2 + 2*q3 + 2*q4) + l2*sin(2*q2 + q3 + q4) + l2*sin(q3 + q4) + l3*sin(q4) + l3*sin(2*q2 + 2*q3 + q4)))/2;...
    q1_p*((l3^2*m3*sin(2*q2 + 2*q3))/2 + (l3^2*m4*sin(2*q2 + 2*q3))/2 + (l2^2*m2*sin(2*q2))/2 + (l2^2*m3*sin(2*q2))/2 + (l2^2*m4*sin(2*q2))/2 + (l4^2*m4*sin(2*q2 + 2*q3 + 2*q4))/2 + l2*l4*m4*sin(2*q2 + q3 + q4) + l3*l4*m4*sin(2*q2 + 2*q3 + q4) + l2*l3*m3*sin(2*q2 + q3) + l2*l3*m4*sin(2*q2 + q3)),                                                                                                                                                                                - q4_p*(l2*l4*m4*sin(q3 + q4) + l3*l4*m4*sin(q4)) - q3_p*(l2*l4*m4*sin(q3 + q4) + l2*l3*m3*sin(q3) + l2*l3*m4*sin(q3)),                                                                                                                                           - l2*q2_p*(l3*m3*sin(q3) + l3*m4*sin(q3) + l4*m4*sin(q3 + q4)) - l2*q3_p*(l3*m3*sin(q3) + l3*m4*sin(q3) + l4*m4*sin(q3 + q4)) - l4*m4*q4_p*(l2*sin(q3 + q4) + l3*sin(q4)),                                                                      -l4*m4*(l2*sin(q3 + q4) + l3*sin(q4))*(q2_p + q3_p + q4_p);...
    q1_p*((l3^2*m3*sin(2*q2 + 2*q3))/2 + (l3^2*m4*sin(2*q2 + 2*q3))/2 + (l4^2*m4*sin(2*q2 + 2*q3 + 2*q4))/2 + (l2*l4*m4*sin(2*q2 + q3 + q4))/2 + (l2*l4*m4*sin(q3 + q4))/2 + (l2*l3*m3*sin(q3))/2 + (l2*l3*m4*sin(q3))/2 + l3*l4*m4*sin(2*q2 + 2*q3 + q4) + (l2*l3*m3*sin(2*q2 + q3))/2 + (l2*l3*m4*sin(2*q2 + q3))/2),                                                                                                                                                                                                            q2_p*(l2*l4*m4*sin(q3 + q4) + l2*l3*m3*sin(q3) + l2*l3*m4*sin(q3)) - l3*l4*m4*q4_p*sin(q4),                                                                                                                                                                                                                                                                                              -l3*l4*m4*q4_p*sin(q4),                                                                                          -l3*l4*m4*sin(q4)*(q2_p + q3_p + q4_p);...
    (l4*m4*q1_p*(l4*sin(2*q2 + 2*q3 + 2*q4) + l2*sin(2*q2 + q3 + q4) + l2*sin(q3 + q4) + l3*sin(q4) + l3*sin(2*q2 + 2*q3 + q4)))/2,                                                                                                                                                                                                                               q2_p*(l2*l4*m4*sin(q3 + q4) + l3*l4*m4*sin(q4)) + l3*l4*m4*q3_p*sin(q4),                                                                                                                                                                                                                                                                                      l3*l4*m4*sin(q4)*(q2_p + q3_p),                                                                                                                               0];

end